--- a/accel-pppd/CMakeLists.txt	2012-06-15 18:05:12.000000000 +0400
+++ b/accel-pppd/CMakeLists.txt	2012-07-16 15:09:39.579798975 +0400
@@ -17,6 +17,12 @@
 
 INCLUDE_DIRECTORIES(include)
 
+# OpenWRT
+SET(IN_OPENWRT $ENV{TARGET_OPENWRT})
+IF (IN_OPENWRT)
+	SET(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} $ENV{TARGET_CPPFLAGS} $ENV{TARGET_CFLAGS} $ENV{TARGET_LDFLAGS} ")
+ENDIF(IN_OPENWRT)
+
 IF (MEMDEBUG)
 	ADD_DEFINITIONS(-DMEMDEBUG)
 	IF (VALGRIND)
@@ -39,7 +45,6 @@
 ADD_SUBDIRECTORY(logs)
 ADD_SUBDIRECTORY(extra)
 ADD_SUBDIRECTORY(ipv6)
-ADD_SUBDIRECTORY(shaper)
 
 ADD_EXECUTABLE(accel-pppd
 	ppp/ppp.c
